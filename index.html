<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìƒì‚¬ í˜¼ë‚´ì£¼ê¸° ê²Œì„</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Malgun Gothic', sans-serif; background: linear-gradient(to bottom, #1a1a2e, #16213e); color: white; }
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        .header { display: flex; justify-content: space-between; background: rgba(0,0,0,0.7); padding: 15px 25px; border-radius: 10px; margin-bottom: 15px; }
        .stat { font-size: 16px; margin: 3px 0; }
        .office { position: relative; background: linear-gradient(to bottom, #e0f2fe, #cbd5e1); height: 550px; border-radius: 10px; overflow: hidden; border: 3px solid #334155; }
        
        .desk { position: absolute; width: 50px; height: 35px; background: #92400e; border: 2px solid #78350f; border-radius: 3px; }
        
        .person { position: absolute; display: flex; flex-direction: column; align-items: center; cursor: pointer; transition: transform 0.2s; }
        .person:hover { transform: scale(1.05); }
        .head { width: 20px; height: 20px; background: #fbbf24; border-radius: 50%; border: 1.5px solid #000; position: relative; margin-bottom: 2px; }
        .head.boss { background: #ef4444; }
        .head.player { background: #10b981; }
        .head.bald { background: #ffc6a5; }
        .hair { position: absolute; top: -3px; left: 50%; transform: translateX(-50%); font-size: 12px; }
        .eyes { position: absolute; top: 6px; left: 5px; font-size: 6px; }
        .body { width: 18px; height: 25px; background: #3b82f6; border: 1.5px solid #000; border-radius: 3px; margin-bottom: 2px; }
        .body.boss { background: #991b1b; }
        .body.player { background: #059669; }
        .body.fat { width: 28px; height: 30px; }
        .body.tall { height: 35px; }
        .legs { display: flex; gap: 3px; }
        .leg { width: 6px; height: 18px; background: #1e3a8a; border: 1px solid #000; border-radius: 2px; }
        .leg.boss { background: #7f1d1d; }
        .leg.player { background: #065f46; }
        .leg.tall { height: 25px; }
        
        .label { position: absolute; bottom: -18px; font-size: 9px; padding: 2px 6px; border-radius: 4px; white-space: nowrap; font-weight: bold; }
        .boss-label { background: #dc2626; color: white; }
        .player-label { background: #10b981; color: white; }
        
        .noise { position: absolute; top: -20px; font-size: 16px; animation: shake 0.5s infinite; }
        @keyframes shake { 0%, 100% { transform: rotate(-5deg); } 50% { transform: rotate(5deg); } }
        
        .warning { position: fixed; top: 20%; left: 50%; transform: translate(-50%, -50%); background: #dc2626; padding: 25px 50px; border-radius: 12px; border: 3px solid #fbbf24; z-index: 100; display: none; animation: pulse 1s infinite; }
        @keyframes pulse { 0%, 100% { transform: translate(-50%, -50%) scale(1); } 50% { transform: translate(-50%, -50%) scale(1.05); } }
        
        .weapon-popup { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.9); display: none; align-items: center; justify-content: center; z-index: 200; }
        .weapon-content { background: #374151; padding: 30px; border-radius: 12px; max-width: 550px; }
        .weapon-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-top: 15px; }
        .weapon-btn { background: linear-gradient(to bottom, #dc2626, #991b1b); border: 3px solid #fbbf24; padding: 15px; border-radius: 8px; cursor: pointer; color: white; font-size: 14px; transition: transform 0.2s; }
        .weapon-btn:hover { transform: scale(1.08); }
        
        .hit-effect { position: absolute; font-size: 50px; animation: explode 0.7s forwards; pointer-events: none; z-index: 150; }
        @keyframes explode { 0% { transform: translate(-50%, -50%) scale(1); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(2); opacity: 0; } }
        
        .knocked-down { animation: fall 0.6s forwards; }
        @keyframes fall { 
            0% { transform: rotate(0deg); } 
            50% { transform: rotate(45deg) translateY(10px); } 
            100% { transform: rotate(90deg) translateY(15px); } 
        }
        
        .shop { background: rgba(0,0,0,0.7); padding: 15px; border-radius: 10px; margin-top: 15px; }
        .shop-grid { display: grid; grid-template-columns: repeat(6, 1fr); gap: 8px; margin-top: 12px; }
        .shop-item { background: #374151; border: 2px solid #4b5563; padding: 10px; border-radius: 6px; text-align: center; font-size: 11px; }
        .shop-item.owned { border-color: #10b981; }
        .buy-btn { width: 100%; margin-top: 6px; padding: 4px; border: none; border-radius: 4px; cursor: pointer; font-size: 10px; font-weight: bold; }
        .buy-btn.available { background: #10b981; color: white; }
        .buy-btn:disabled { background: #4b5563; color: #9ca3af; cursor: not-allowed; }
        
        .char-select { position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.95); display: flex; align-items: center; justify-content: center; z-index: 300; }
        .char-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 25px; }
        .char-option { background: #374151; border: 3px solid #fbbf24; padding: 25px; border-radius: 12px; cursor: pointer; text-align: center; transition: all 0.2s; }
        .char-option:hover { background: #4b5563; transform: scale(1.05); }
    </style>
</head>
<body>
    <div class="char-select" id="charSelect">
        <div>
            <h2 style="text-align: center; font-size: 32px; margin-bottom: 35px; color: #fbbf24;">ìºë¦­í„° ì„ íƒ</h2>
            <div style="text-align: center;">
                <div class="char-option" onclick="selectChar('ë‚˜')" style="display: inline-block;">
                    <div style="font-size: 55px; margin-bottom: 12px;">ğŸ‘©</div>
                    <div style="font-size: 22px; font-weight: bold;">ë‚˜</div>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <div class="header">
            <div><h1 style="font-size: 26px;">ğŸ¢ ìƒì‚¬ í˜¼ë‚´ì£¼ê¸°</h1></div>
            <div style="text-align: right;">
                <div class="stat" style="color: #fbbf24;">ğŸ’° <span id="coins">0</span></div>
                <div class="stat" style="color: #10b981;">ğŸ’ª <span id="score">0</span></div>
                <div class="stat" style="color: #ef4444;">ğŸ‘Š <span id="hits">0</span>íšŒ</div>
            </div>
        </div>

        <div class="warning" id="warning">
            <h2 style="font-size: 22px; margin-bottom: 8px;">âš ï¸ ê²½ê³ !</h2>
            <p id="warningText" style="font-size: 16px;"></p>
        </div>

        <div class="office" id="office"></div>

        <div class="weapon-popup" id="weaponPopup">
            <div class="weapon-content">
                <h2 style="text-align: center; margin-bottom: 18px; font-size: 24px; color: white;">
                    ğŸ¯ <span id="targetName"></span> ê³µê²©!
                </h2>
                <div class="weapon-grid" id="weaponGrid"></div>
                <button onclick="closePopup()" style="width: 100%; margin-top: 18px; padding: 10px; background: #4b5563; border: none; border-radius: 6px; color: white; cursor: pointer; font-size: 15px; font-weight: bold;">ì·¨ì†Œ</button>
            </div>
        </div>

        <div class="shop">
            <h3 style="font-size: 20px; margin-bottom: 12px;">ğŸ›’ ë¬´ê¸° ìƒì </h3>
            <div class="shop-grid" id="shopGrid"></div>
        </div>
    </div>

    <script>
        const game = {
            score: 0, coins: 0, hits: 0, target: null, myChar: null,
            positions: {
                'ã„±ã…ˆ': {x: 10, y: 20, sitting: true},
                'ã……ã…‚': {x: 30, y: 20, sitting: true},
                'ë‚˜': {x: 50, y: 20, sitting: true},
                'ã…ˆã„¹': {x: 30, y: 45, sitting: false, homeX: 30, homeY: 45},
                'ã…ã…‡': {x: 70, y: 50, sitting: true},
                'ã…ˆã…': {x: 50, y: 70, sitting: true},
                'í›ˆë°œë†ˆ': {x: 50, y: 90, sitting: false, homeX: 50, homeY: 90},
                'ì¯”í—ˆ': {x: 85, y: 90, sitting: false, homeX: 85, homeY: 90}
            },
            bosses: {
                'ã„±ã…ˆ': {moving: false, targetChar: null, sitting: true},
                'ã…ˆã„¹': {moving: false, x: 30, y: 45, noise: true},
                'í›ˆë°œë†ˆ': {moving: false, x: 50, y: 90, noise: true},
                'ì¯”í—ˆ': {moving: false, x: 85, y: 90, talking: false}
            },
            weapons: [
                {name: 'ì£¼ë¨¹', dmg: 10, icon: 'ğŸ‘Š', cost: 0},
                {name: 'í‚¤ë³´ë“œ', dmg: 20, icon: 'âŒ¨ï¸', cost: 50},
                {name: 'ë§ˆìš°ìŠ¤', dmg: 30, icon: 'ğŸ–±ï¸', cost: 100},
                {name: 'ì»¤í”¼', dmg: 50, icon: 'â˜•', cost: 200},
                {name: 'ë…¸íŠ¸ë¶', dmg: 80, icon: 'ğŸ’»', cost: 400},
                {name: 'ì˜ì', dmg: 120, icon: 'ğŸª‘', cost: 800}
            ],
            owned: [true, false, false, false, false, false]
        };

        function selectChar(name) {
            game.myChar = name;
            document.getElementById('charSelect').style.display = 'none';
            init();
        }

        function createPerson(isBoss, label, hasNoise, bossType) {
            let headClass = isBoss ? 'boss' : 'player';
            let bodyClass = 'body ' + (isBoss ? 'boss' : 'player');
            let legClass = 'leg ' + (isBoss ? 'boss' : 'player');
            let hair = '';
            
            // ìºë¦­í„°ë³„ ì™¸í˜•
            if (bossType === 'ã„±ã…ˆ' || bossType === 'í›ˆë°œë†ˆ') {
                bodyClass += ' fat'; // ëš±ëš±
                hair = '<div class="hair">ğŸ©</div>'; // ë¨¸ë¦¬ì¹´ë½
            } else if (bossType === 'ã…ˆã„¹') {
                headClass += ' bald'; // ëŒ€ë¨¸ë¦¬
            } else if (bossType === 'ì¯”í—ˆ') {
                headClass += ' bald'; // ëŒ€ë¨¸ë¦¬
                bodyClass += ' tall'; // í‚¤í¼
                legClass += ' tall'; // ë‹¤ë¦¬ ê¹€
            }
            
            return `
                <div class="head ${headClass}">
                    ${hair}
                    <div class="eyes">ğŸ‘€</div>
                </div>
                <div class="${bodyClass}"></div>
                <div class="legs">
                    <div class="${legClass}"></div>
                    <div class="${legClass}"></div>
                </div>
                <div class="label ${isBoss ? 'boss-label' : 'player-label'}">${label}</div>
                ${hasNoise ? '<div class="noise">ğŸ’¢ğŸ’¢</div>' : ''}
            `;
        }

        function init() {
            const office = document.getElementById('office');
            office.innerHTML = '';
            
            Object.entries(game.positions).forEach(([name, pos]) => {
                const desk = document.createElement('div');
                desk.className = 'desk';
                desk.style.left = pos.x + '%';
                desk.style.top = pos.y + '%';
                office.appendChild(desk);
            });
            
            ['ã„±ã…ˆ', 'ã……ã…‚', 'ë‚˜', 'ã…ã…‡', 'ã…ˆã…'].forEach(name => {
                const pos = game.positions[name];
                const person = document.createElement('div');
                person.className = 'person';
                person.id = 'char-' + name;
                person.style.left = (pos.x + 2) + '%';
                person.style.top = (pos.y - 5) + '%';
                person.innerHTML = createPerson(name === 'ã„±ã…ˆ', name, false, name === 'ã„±ã…ˆ' ? 'ã„±ã…ˆ' : null);
                if (name === 'ã„±ã…ˆ' && (game.myChar === 'ë‚˜' || game.myChar === 'ìƒë¹ˆ')) {
                    person.onclick = () => showWeapon('ã„±ã…ˆ');
                }
                office.appendChild(person);
            });
            
            ['ã…ˆã„¹', 'í›ˆë°œë†ˆ', 'ì¯”í—ˆ'].forEach(name => {
                const boss = game.bosses[name];
                const person = document.createElement('div');
                person.className = 'person';
                person.id = 'boss-' + name;
                person.style.left = boss.x + '%';
                person.style.top = boss.y + '%';
                person.innerHTML = createPerson(true, name, boss.noise, name);
                person.onclick = () => showWeapon(name);
                office.appendChild(person);
            });
        }

        function moveBosses() {
            const gj = game.bosses['ã„±ã…ˆ'];
            if (!gj.moving && Math.random() < 0.015 && game.myChar === 'ë‚˜') {
                gj.moving = true;
                gj.sitting = false;
                gj.targetChar = game.myChar;
                const targetPos = game.positions[game.myChar];
                gj.targetX = targetPos.x + 2;
                gj.targetY = targetPos.y + 15;
            }
            
            if (gj.moving) {
                const el = document.getElementById('char-ã„±ã…ˆ');
                if (!el) return;
                const currentX = parseFloat(el.style.left);
                const currentY = parseFloat(el.style.top);
                const dx = gj.targetX - currentX;
                const dy = gj.targetY - currentY;
                const dist = Math.sqrt(dx*dx + dy*dy);
                
                if (dist < 1) {
                    gj.moving = false;
                } else {
                    el.style.left = (currentX + dx/dist * 0.3) + '%';
                    el.style.top = (currentY + dy/dist * 0.3) + '%';
                    
                    if (dist < 12) {
                        document.getElementById('warning').style.display = 'block';
                        document.getElementById('warningText').textContent = 'ã„±ã…ˆì´ ë’¤ì—ì„œ í›”ì³ë³´ê³  ìˆì–´ìš”!';
                    }
                }
            } else {
                document.getElementById('warning').style.display = 'none';
            }
            
            ['ã…ˆã„¹', 'í›ˆë°œë†ˆ', 'ì¯”í—ˆ'].forEach(name => {
                const boss = game.bosses[name];
                const el = document.getElementById('boss-' + name);
                if (!el) return;
                
                if (!boss.moving && Math.random() < 0.02) {
                    boss.moving = true;
                    if (name === 'ì¯”í—ˆ' && Math.random() < 0.5) {
                        const targets = ['ã…ã…‡', 'ã…ˆã…'];
                        const randomTarget = targets[Math.floor(Math.random() * targets.length)];
                        const targetPos = game.positions[randomTarget];
                        boss.targetX = targetPos.x + 2;
                        boss.targetY = targetPos.y + 15;
                        boss.talking = true;
                    } else {
                        boss.targetX = Math.random() * 75 + 10;
                        boss.targetY = Math.random() * 65 + 20;
                    }
                }
                
                if (boss.moving) {
                    const dx = boss.targetX - boss.x;
                    const dy = boss.targetY - boss.y;
                    const dist = Math.sqrt(dx*dx + dy*dy);
                    
                    if (dist < 1) {
                        boss.moving = false;
                        if (name === 'ì¯”í—ˆ' && boss.talking) {
                            const office = document.getElementById('office');
                            const existingBubble = document.getElementById('speech-bubble');
                            if (existingBubble) existingBubble.remove();
                            
                            const bubble = document.createElement('div');
                            bubble.style.position = 'absolute';
                            bubble.style.left = boss.x + '%';
                            bubble.style.top = (boss.y - 8) + '%';
                            bubble.style.background = 'white';
                            bubble.style.color = 'black';
                            bubble.style.padding = '5px 10px';
                            bubble.style.borderRadius = '10px';
                            bubble.style.fontSize = '11px';
                            bubble.style.fontWeight = 'bold';
                            bubble.style.border = '2px solid #000';
                            bubble.style.zIndex = '120';
                            bubble.textContent = 'ì˜ë˜ê°€? ğŸ˜';
                            bubble.id = 'speech-bubble';
                            office.appendChild(bubble);
                            setTimeout(() => {
                                const b = document.getElementById('speech-bubble');
                                if (b) b.remove();
                            }, 3000);
                        }
                        boss.talking = false;
                    } else {
                        boss.x += dx/dist * 0.6;
                        boss.y += dy/dist * 0.6;
                        el.style.left = boss.x + '%';
                        el.style.top = boss.y + '%';
                    }
                }
            });
        }

        function showWeapon(bossName) {
            if (bossName === 'ã„±ã…ˆ' && game.myChar !== 'ë‚˜') return;
            
            game.target = bossName;
            document.getElementById('targetName').textContent = bossName;
            const grid = document.getElementById('weaponGrid');
            grid.innerHTML = '';
            game.weapons.forEach((w, i) => {
                if (game.owned[i]) {
                    const btn = document.createElement('button');
                    btn.className = 'weapon-btn';
                    btn.innerHTML = `<div style="font-size: 35px; margin-bottom: 8px;">${w.icon}</div><div style="font-weight: bold;">${w.name}</div><div style="color: #fbbf24;">ğŸ’¥ ${w.dmg}</div>`;
                    btn.onclick = () => attack(i);
                    grid.appendChild(btn);
                }
            });
            document.getElementById('weaponPopup').style.display = 'flex';
        }

        function closePopup() {
            document.getElementById('weaponPopup').style.display = 'none';
        }

        function attack(idx) {
            const w = game.weapons[idx];
            game.score += w.dmg;
            game.coins += w.dmg;
            game.hits++;
            updateStats();
            renderShop();
            
            const office = document.getElementById('office');
            let targetEl, targetX, targetY;
            
            if (game.target === 'ã„±ã…ˆ') {
                targetEl = document.getElementById('char-ã„±ã…ˆ');
            } else {
                targetEl = document.getElementById('boss-' + game.target);
            }
            
            if (targetEl) {
                targetX = parseFloat(targetEl.style.left);
                targetY = parseFloat(targetEl.style.top);
                
                targetEl.classList.add('knocked-down');
                
                const hit = document.createElement('div');
                hit.className = 'hit-effect';
                hit.textContent = w.icon + 'ğŸ’¥';
                hit.style.position = 'absolute';
                hit.style.left = targetX + '%';
                hit.style.top = targetY + '%';
                office.appendChild(hit);
                setTimeout(() => hit.remove(), 700);
                
                setTimeout(() => {
                    targetEl.classList.remove('knocked-down');
                    
                    if (game.target === 'ã„±ã…ˆ') {
                        game.bosses['ã„±ã…ˆ'].moving = false;
                        game.bosses['ã„±ã…ˆ'].sitting = true;
                        targetEl.style.left = (game.positions['ã„±ã…ˆ'].x + 2) + '%';
                        targetEl.style.top = (game.positions['ã„±ã…ˆ'].y - 5) + '%';
                    } else {
                        const boss = game.bosses[game.target];
                        boss.moving = false;
                        boss.talking = false;
                        boss.x = boss.homeX || game.positions[game.target].homeX;
                        boss.y = boss.homeY || game.positions[game.target].homeY;
                        targetEl.style.left = boss.x + '%';
                        targetEl.style.top = boss.y + '%';
                    }
                }, 600);
            }
            
            closePopup();
            document.getElementById('warning').style.display = 'none';
        }

        function buy(idx) {
            const w = game.weapons[idx];
            if (game.coins >= w.cost && !game.owned[idx]) {
                game.coins -= w.cost;
                game.owned[idx] = true;
                updateStats();
                renderShop();
            }
        }

        function updateStats() {
            document.getElementById('score').textContent = game.score;
            document.getElementById('coins').textContent = game.coins;
            document.getElementById('hits').textContent = game.hits;
        }

        function renderShop() {
            const grid = document.getElementById('shopGrid');
            grid.innerHTML = '';
            game.weapons.forEach((w, i) => {
                const div = document.createElement('div');
                div.className = 'shop-item' + (game.owned[i] ? ' owned' : '');
                div.innerHTML = `<div style="font-size: 24px; margin-bottom: 4px;">${w.icon}</div><div style="font-weight: bold;">${w.name}</div><div style="color: #fbbf24; font-size: 10px;">ğŸ’¥ ${w.dmg}</div>`;
                if (!game.owned[i]) {
                    const btn = document.createElement('button');
                    const canBuy = game.coins >= w.cost;
                    btn.className = 'buy-btn' + (canBuy ? ' available' : '');
                    btn.textContent = 'ğŸ’° ' + w.cost;
                    btn.disabled = !canBuy;
                    btn.style.cursor = canBuy ? 'pointer' : 'not-allowed';
                    btn.onclick = function() {
                        if (canBuy) {
                            buy(i);
                        }
                    };
                    div.appendChild(btn);
                } else {
                    div.innerHTML += '<div style="color: #10b981; margin-top: 6px; font-weight: bold; font-size: 10px;">âœ…</div>';
                }
                grid.appendChild(div);
            });
        }

        setInterval(moveBosses, 100);
        updateStats();
        renderShop();
    </script>
</body>
</html>